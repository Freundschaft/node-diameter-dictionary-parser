Copied from Wireshark, please contribute any changes back to them. 